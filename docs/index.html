<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.29.0">


<link href="css/style.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="js/doc.js"></script>
<script type="text/javascript">
  CrystalDoc.base_path = "";
</script>

  <meta id="repository-name" content="github.com/watzon/nacl">
  <title>README - github.com/watzon/nacl</title>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="repository-links">
      <a href="index.html">README</a>
    </div>
  </div>

  <div class="search-results" class="hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl" data-name="nacl">
      <a href="NaCl.html">NaCl</a>
      
        <ul>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl/AEAD" data-name="nacl::aead">
      <a href="NaCl/AEAD.html">AEAD</a>
      
        <ul>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/AEAD/Base" data-name="nacl::aead::base">
      <a href="NaCl/AEAD/Base.html">Base</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/AEAD/XChaCha20Poly1305" data-name="nacl::aead::xchacha20poly1305">
      <a href="NaCl/AEAD/XChaCha20Poly1305.html">XChaCha20Poly1305</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/BadSignatureError" data-name="nacl::badsignatureerror">
      <a href="NaCl/BadSignatureError.html">BadSignatureError</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/CryptoError" data-name="nacl::cryptoerror">
      <a href="NaCl/CryptoError.html">CryptoError</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Error" data-name="nacl::error">
      <a href="NaCl/Error.html">Error</a>
      
    </li>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl/Hash" data-name="nacl::hash">
      <a href="NaCl/Hash.html">Hash</a>
      
        <ul>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl/Hash/Blake2b" data-name="nacl::hash::blake2b">
      <a href="NaCl/Hash/Blake2b.html">Blake2b</a>
      
        <ul>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Hash/Blake2b/State" data-name="nacl::hash::blake2b::state">
      <a href="NaCl/Hash/Blake2b/State.html">State</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/KeyComparator" data-name="nacl::keycomparator">
      <a href="NaCl/KeyComparator.html">KeyComparator</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/LengthError" data-name="nacl::lengtherror">
      <a href="NaCl/LengthError.html">LengthError</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Random" data-name="nacl::random">
      <a href="NaCl/Random.html">Random</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Serializable" data-name="nacl::serializable">
      <a href="NaCl/Serializable.html">Serializable</a>
      
    </li>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl/Signatures" data-name="nacl::signatures">
      <a href="NaCl/Signatures.html">Signatures</a>
      
        <ul>
  
  <li class="parent " data-id="github.com/watzon/nacl/NaCl/Signatures/Ed25519" data-name="nacl::signatures::ed25519">
      <a href="NaCl/Signatures/Ed25519.html">Ed25519</a>
      
        <ul>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Signatures/Ed25519/SigningKey" data-name="nacl::signatures::ed25519::signingkey">
      <a href="NaCl/Signatures/Ed25519/SigningKey.html">SigningKey</a>
      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Signatures/Ed25519/VerifyKey" data-name="nacl::signatures::ed25519::verifykey">
      <a href="NaCl/Signatures/Ed25519/VerifyKey.html">VerifyKey</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/watzon/nacl/NaCl/Util" data-name="nacl::util">
      <a href="NaCl/Util.html">Util</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1>NaCl</h1>

<p>Full Crystal binidings to <a href="https://libsodium.org" target="_blank">libsodium</a>. Very much a work in progress, but the lib bindings are there.</p>

<h2>Installation</h2>

<ol><li>Make sure you have <code>libsodium</code> installed on your system.</li></ol>

<pre><code class="language-bash"># Debian
sudo apt install libsodium23

# Arch
sudo pacman -S libsodium

# Fedora
sudo yum install libsodium</code></pre>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<p><code></code>`yaml
   dependencies:</p>

<pre><code> nacl:
   github: watzon<span class="s">/nacl</code></pre>

<p><code></code>`</p>

<ol><li>Run <code>shards install</code></li></ol>

<h2>Usage</h2>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;nacl&quot;</span></code></pre>

<h4>Secret Key Encryption</h4>

<h5>XChaCha20Poly1305</h5>

<pre><code class="language-crystal"><span class="c"># Generate a random secret key</span>
key <span class="o">=</span> <span class="t">NaCl</span><span class="t">::</span><span class="t">AEAD</span><span class="t">::</span><span class="t">XChaCha20Poly1305</span>.keygen

<span class="c"># Initialize a XChaCha20Poly1305 cipher object</span>
cipher <span class="o">=</span> <span class="t">NaCl</span><span class="t">::</span><span class="t">AEAD</span><span class="t">::</span><span class="t">XChaCha20Poly1305</span>.<span class="k">new</span>(key)

<span class="c"># Generate a random nonce: a single-use value never repeated under the same key.</span>
<span class="c"># The nonce isn&#39;t secret, and can be sent with the ciphertext.</span>
<span class="c"># The cipher instance has a nonce_bytes method for determining how many bytes should be in a nonce.</span>
nonce <span class="o">=</span> <span class="t">NaCl</span><span class="t">::</span><span class="t">Random</span>.random_bytes(cipher.nonce_bytes)

<span class="c"># Encrypt a message with XChaCha20Poly1305</span>
message <span class="o">=</span> <span class="s">&quot;Crystal is amazing&quot;</span> <span class="c"># Message to be encrypted</span>
ad <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="c"># Additional data sent *in the clear* to be authenticated. This can be `nil`.</span>
ciphertext <span class="o">=</span> cipher.encrypt_string(nonce, message, ad)
<span class="c"># =&gt; &quot;...&quot; string of random bytes, 16 bytes longer than the message.</span>
<span class="c"># The extra 16 bytes are the authenticator.</span>

<span class="c"># Decrypt a message, passing in the same additional data we used to encrypt.</span>
decrypted_message <span class="o">=</span> cipher.decrypt_string(nonce, ciphertext, ad)
<span class="c"># =&gt; &quot;Crystal is amazing&quot;</span>

<span class="c"># But if the cipher has been tampered with:</span>
cipher.decrypt_string(nonce, corrupted_ciphertext, ad)
<span class="c"># =&gt; NaCl::CryptoError</span>

<span class="c"># For encrypting bytes you can use:</span>
ciphertext <span class="o">=</span> cipher.encrypt(nonce, message.bytes, ad)

<span class="c"># And to decrypt back to bytes</span>
decrypted_bytes <span class="o">=</span> cipher.decrypt(nonce, ciphertext, ad)
<span class="c"># =&gt; Bytes[...]</span></code></pre>

<h4>Digital Signatures</h4>

<h5>Signer's Perspective</h5>

<pre><code class="language-crystal"><span class="c"># Generate a new random signing key</span>
signing_key <span class="o">=</span> <span class="t">NaCl</span><span class="t">::</span><span class="t">SigningKey</span>.generate

<span class="c"># Message to be signed</span>
message <span class="o">=</span> <span class="s">&quot;Crystal is amazing

# Sign a message with the signing key
signature = signing_key.sign(message)

# Obtain the verify key for a given signing key
verify_key = signing_key.verify_key

# Convert the verify key to a string to send it to a third party
verify_key.to_s</code></pre>

<h5>Verifier's Perspective</h5>

<pre><code class="language-crystal"><span class="c"># Create a VerifyKey object from a public key</span>
verify_key <span class="o">=</span> <span class="t">NaCl</span><span class="t">::</span><span class="t">VerifyKey</span>.<span class="k">new</span>(verify_key.bytes)

<span class="c"># Check the validity of a message&#39;s signature</span>
<span class="c"># Will raise NaCl::BadSignatureError if the signature check fails</span>
verify_key.verify(signature, message)</code></pre>

<h2>Supported</h2>

<ul><li>[ ] SimpleBox (simplified cryptography)</li><li>[ ] Secret-key Encryption</li><ul><li>[ ] <a href="#" target="_blank">NaCl::SecretBox</a></li><li>[x] <a href="#" target="_blank">NaCl::AEAD::XChaCha20Poly1305</a></li><li>[ ] <a href="#" target="_blank">NaCl::AEAD::ChaCha20Poly1305IETF</a></li><li>[ ] <a href="#" target="_blank">NaCl::AEAD::ChaCha20Poly1305Legacy</a></li></ul><li>[ ] Public-key Encryption</li><ul><li>[ ] <a href="#" target="_blank">NaCl::Box</a></li><li>[ ] <a href="#" target="_blank">NaCl::PrivateKey</a></li><li>[ ] <a href="#" target="_blank">NaCl::PublicKey</a></li></ul><li>[x] Digital Signatures</li><ul><li>[x] <a href="#" target="_blank">NaCl::SigningKey</a></li><li>[x] <a href="#" target="_blank">NaCl::VerifyKey</a></li></ul><li>[ ] HMAC</li><ul><li>[ ] <a href="#" target="_blank">NaCl::HMAC::SHA256</a></li><li>[ ] <a href="#" target="_blank">NaCl::HMAC::SHA512256</a></li></ul><li>[ ] Hash Functions</li><ul><li>[ ] <a href="#" target="_blank">NaCl::Hash</a></li></ul><li>[ ] Password Hashing</li><ul><li>[ ] <a href="#" target="_blank">NaCl::PasswordHash</a></li></ul><li>[ ] Scalar Manipulation</li><ul><li>[ ] <a href="#" target="_blank">NaCl::GroupElement</a></li></ul><li>[ ] One-time Authentication</li><li>[ ] Random Number Generation</li><li>[x] Utilities</li><ul><li>[x] Constant-time byte comparison</li></ul></ul>

<h2>Contributing</h2>

<ol><li>Fork it (&lt;https://github.com/watzon/nacl/fork>)</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol>

<h2>Contributors</h2>

<ul><li><a href="https://github.com/watzon" target="_blank">Chris Watson</a> - creator and maintainer</li></ul>
</div>
</body>
</html>
